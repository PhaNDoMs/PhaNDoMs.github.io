---
title: Pentestit Test Lab v10 WriteUp - Mail Token
categories: ['CTF WriteUp']
tags: ['Hacking']
---

# Intro/Network
Lets look at the network diagram first:
![Image]({{ site.baseurl }}/images/testlabv10network.png)

Seems like a gray/whitebox lab, nice! Now to reach the internal networks we have to get past the gateway. After connecting to the VPN we can start attacking.

# Gathering Info
Since we can only attack the gateway, lets start gathering some info. Doing a quick nmap scan reveales the following open ports.
![Image]({{ site.baseurl }}/images/testlabv10gwnmap.png)

Usually, websites are a good start to get more info, lets check them out.

## Web on port 80
Accessing the website on port 80 brings me to their main homepage. I searched through it for a long time but couldnt find anything useful. After that I decided to continue to port 443.

## Web on port 443
Accessing the website on port 443 lead me to some kind of security blog. Searching the website for info, I found the following comment in the source:

{% highlight html %}
<!-- Alfred Modlin said use this template -->
{% endhighlight %}

hmm, looks like a employees name. maybe we can use that name later?

Searching further through the site, I found the following 2 emails on the contact site:

{% highlight html %}
Scott Locklear- s.locklear@gds.lab
Joshua Wise- j.wise@gds.lab
{% endhighlight %}

Now we know the e-mail format for the company! Combine that with the name found earlier, we possibly have another user: a.modlin@gds.lab!

## Web on port 8100
Moving on to port 8100, which looks like another webserver. Accessing the website itself brings me to a login-form of their webmail. Maybe we can bruteforce a users login via the login-form?


# Bruteforcing login
Since we want to try all possible users, ive added the found emails to a file named "users.txt". After that I started to bruteforce the login-form on http://192.168.101.9:8100/login/ with the following command:

{% highlight shell %}
hydra -v -t 16 -L users.txt -P /root/Desktop/wordlists/john.txt http-post://192.168.101.9:8100/login/
{% endhighlight %}

With success! We found the login for a.modlin:

{% highlight shell %}
[8100][http-post] host: 192.168.101.9 login: a.modlin@gds.lab password: justdoit
[STATUS] attack finished for 192.168.101.9 (waiting for children to complete tests)
1 of 1 target successfully completed, 1 valid password found
{% endhighlight %}

After logging in with the found credentials, I found 2 E-Mails with one of them containing the token. Task Done!
